<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="../bundle/babel.min.js"></script>
    <!-- <script src="../bundle/react.development.js"></script> -->
    <!-- <script src="../bundle/react-dom.development.js"></script> -->
    <!-- <script src="../bundle/react.18.development.js"></script> -->
    <!-- <script src="../bundle/react-dom.18.development.js"></script> -->
    <script src="../packages/myreact/dist/umd/index.development.js"></script>
    <script src="../packages/myreact-dom/dist/umd/index.development.js"></script>
  </head>

  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useRef, Suspense, useEffect } = React;

      const Demo = ({ active }) => {
        console.log("demo", active);

        const resolveRef = useRef();

        console.log("render", active);

        const [f, setF] = useState(null);

        useEffect(() => {
          if (!active) {
            setF(new Promise(r => null));
          } else {
            setF(null);
          }
          console.log("effect", active);
        }, [active]);

        console.log(f);

        if (f) throw f;

        // if (!active) throw new Promise(r => null);

        const ref = useRef({});

        console.log(ref.current);

        return (
          <div>
            <span>this is demo:{String(active)}</span>
          </div>
        );
      };

      const App = () => {
        const [active, setActive] = useState(true);
        const handleToggle = () => {
          setActive(!active);
        };
        console.log("App active", active);
        return (
          <>
            <div
              onClick={handleToggle}
              style={{
                width: "100px",
                height: "100px",
                backgroundColor: active ? "red" : "blue",
              }}
            />
            <Demo active={active} />
          </>
        );
      };

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);

      // ReactDOM.render(<App />, document.getElementById("root"));
    </script>
  </body>
</html>
