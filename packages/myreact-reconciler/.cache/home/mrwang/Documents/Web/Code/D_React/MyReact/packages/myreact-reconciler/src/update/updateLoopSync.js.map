{"version":3,"file":"updateLoopSync.js","sourceRoot":"","sources":["updateLoopSync.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,kBAAkB,EAAE,MAAM,iBAAiB,CAAC;AAErD,OAAO,EAAE,aAAa,EAAE,MAAM,aAAa,CAAC;AAIpC,IAAA,QAAQ,GAAK,kBAAkB,SAAvB,CAAwB;AAExC,MAAM,CAAC,IAAM,cAAc,GAAG,UAC5B,cAMC,EACD,eAA2B;IAE3B,IAAI,cAAc,CAAC,OAAO,EAAE,EAAE;QAC5B,IAAI,KAAK,GAAG,cAAc,CAAC,OAAO,EAAE,CAAC;;YAEnC,IAAM,MAAM,GAAG,KAAyB,CAAC;YACzC,KAAK,GAAG,QAAQ,CAAC,cAAM,OAAA,aAAa,CAAC,MAAM,EAAE,cAAc,CAAC,WAAW,EAAE,CAAC,EAAnD,CAAmD,CAAC,CAAC;YAC5E,cAAc,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACrC,cAAc,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;;QAJjC,OAAO,KAAK;;SAKX;KACF;IACD,eAAe,EAAE,CAAC;AACpB,CAAC,CAAC","sourcesContent":["import { __myreact_shared__ } from \"@my-react/react\";\n\nimport { nextWorkAsync } from \"../generate\";\n\nimport type { MyReactFiberNode } from \"@my-react/react\";\n\nconst { safeCall } = __myreact_shared__;\n\nexport const updateLoopSync = (\n  loopController: {\n    hasNext: () => boolean;\n    getNext: () => MyReactFiberNode | null;\n    getUpdateList: (f: MyReactFiberNode) => void;\n    setYield: (f: MyReactFiberNode | null) => void;\n    getTopLevel: () => MyReactFiberNode | null;\n  },\n  reconcileUpdate: () => void\n) => {\n  if (loopController.hasNext()) {\n    let fiber = loopController.getNext();\n    while (fiber) {\n      const _fiber = fiber as MyReactFiberNode;\n      fiber = safeCall(() => nextWorkAsync(_fiber, loopController.getTopLevel()));\n      loopController.getUpdateList(_fiber);\n      loopController.setYield(fiber);\n    }\n  }\n  reconcileUpdate();\n};\n"]}