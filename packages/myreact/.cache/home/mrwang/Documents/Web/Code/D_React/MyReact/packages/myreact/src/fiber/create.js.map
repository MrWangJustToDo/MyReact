{"version":3,"file":"create.js","sourceRoot":"","sources":["create.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,cAAc,EAAE,MAAM,UAAU,CAAC;AAE1C,OAAO,EAAE,gBAAgB,EAAE,MAAM,YAAY,CAAC;AAI9C,MAAM,CAAC,IAAM,eAAe,GAAG,UAC7B,EAQC,EACD,IAAiB;QARf,UAAU,gBAAA,EACV,MAAM,YAAA,EACN,YAAe,EAAf,IAAI,mBAAG,QAAQ,KAAA;IAQjB,IAAM,YAAY,GAAG,IAAI,gBAAgB,CAAC,UAAU,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;IAEpE,YAAY,CAAC,SAAS,EAAE,CAAC;IAEzB,YAAY,CAAC,WAAW,EAAE,CAAC;IAE3B,YAAY,CAAC,aAAa,EAAE,CAAC;IAE7B,cAAc,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;IAEnD,cAAc,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;IAEnD,IAAI,IAAI,KAAK,QAAQ,EAAE;QACrB,cAAc,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC;KACpD;SAAM;QACL,cAAc,CAAC,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;KACtD;IAED,IAAI,YAAY,CAAC,eAAe,IAAI,YAAY,CAAC,oBAAoB,EAAE;QACrE,IAAK,IAAgB,CAAC,GAAG,EAAE;YACzB,cAAc,CAAC,OAAO,CAAC,mBAAmB,CAAC,YAAY,EAAE,cAAM,OAAA,YAAY,CAAC,QAAQ,EAAE,EAAvB,CAAuB,CAAC,CAAC;SACzF;KACF;IAED,OAAO,YAAY,CAAC;AACtB,CAAC,CAAC","sourcesContent":["import { globalDispatch } from \"../share\";\n\nimport { MyReactFiberNode } from \"./instance\";\n\nimport type { Element, ElementNode } from \"../element\";\n\nexport const createFiberNode = (\n  {\n    fiberIndex,\n    parent,\n    type = \"append\",\n  }: {\n    fiberIndex: number;\n    parent: MyReactFiberNode | null;\n    type?: \"append\" | \"position\";\n  },\n  VDom: ElementNode\n) => {\n  const newFiberNode = new MyReactFiberNode(fiberIndex, parent, VDom);\n\n  newFiberNode.checkVDom();\n\n  newFiberNode.initialType();\n\n  newFiberNode.initialParent();\n\n  globalDispatch.current.pendingCreate(newFiberNode);\n\n  globalDispatch.current.pendingUpdate(newFiberNode);\n\n  if (type === \"append\") {\n    globalDispatch.current.pendingAppend(newFiberNode);\n  } else {\n    globalDispatch.current.pendingPosition(newFiberNode);\n  }\n\n  if (newFiberNode.__isPlainNode__ || newFiberNode.__isClassComponent__) {\n    if ((VDom as Element).ref) {\n      globalDispatch.current.pendingLayoutEffect(newFiberNode, () => newFiberNode.applyRef());\n    }\n  }\n\n  return newFiberNode;\n};\n"]}