{"version":3,"file":"instance.js","sourceRoot":"","sources":["instance.ts"],"names":[],"mappings":"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","sourcesContent":["import { NODE_TYPE_KEY } from \"./type\";\n\nimport type { MyReactFiberNode } from \"../fiber\";\n\nexport class MyReactInternalInstance {\n  __internal_instance_state__: {\n    __fiber__: MyReactFiberNode | null;\n    __context__: MyReactFiberNode | null;\n  } = {\n    __fiber__: null,\n    __context__: null,\n  };\n\n  __internal_instance_update__ = {\n    __pendingEffect__: false,\n  };\n\n  context: null | unknown = null;\n\n  get __fiber__() {\n    return this.__internal_instance_state__.__fiber__;\n  }\n\n  set __fiber__(v) {\n    this.__internal_instance_state__.__fiber__ = v;\n  }\n\n  get __context__() {\n    return this.__internal_instance_state__.__context__;\n  }\n\n  set __context__(v) {\n    this.__internal_instance_state__.__context__ = v;\n  }\n\n  get __pendingEffect__() {\n    return this.__internal_instance_update__.__pendingEffect__;\n  }\n\n  set __pendingEffect__(v) {\n    this.__internal_instance_update__.__pendingEffect__ = v;\n  }\n\n  setContext(context: MyReactFiberNode | null) {\n    if (this.__context__) this.__context__.removeDependence(this);\n    this.__context__ = context;\n    this.__context__?.addDependence(this);\n  }\n\n  setFiber(fiber: MyReactFiberNode) {\n    this.__fiber__ = fiber;\n  }\n\n  unmount() {\n    this.__context__?.removeDependence(this);\n  }\n}\n\nexport class MyReactInternalType {\n  __internal_node_type__ = {\n    __isNullNode__: false,\n    __isTextNode__: false,\n    __isEmptyNode__: false,\n    __isPlainNode__: false,\n    __isStrictNode__: false,\n    __isFragmentNode__: false,\n    // ====  object node ==== //\n    __isObjectNode__: false,\n    __isForwardRef__: false,\n    __isPortal__: false,\n    __isMemo__: false,\n    __isContextProvider__: false,\n    __isContextConsumer__: false,\n    __isLazy__: false,\n    __isSuspense__: false,\n    // ==== dynamic node ==== //\n    __isDynamicNode__: false,\n    __isClassComponent__: false,\n    __isFunctionComponent__: false,\n  };\n\n  get __isNullNode__() {\n    return this.__internal_node_type__.__isNullNode__;\n  }\n\n  get __isTextNode__() {\n    return this.__internal_node_type__.__isTextNode__;\n  }\n  get __isEmptyNode__() {\n    return this.__internal_node_type__.__isEmptyNode__;\n  }\n  get __isPlainNode__() {\n    return this.__internal_node_type__.__isPlainNode__;\n  }\n  get __isStrictNode__() {\n    return this.__internal_node_type__.__isStrictNode__;\n  }\n  get __isFragmentNode__() {\n    return this.__internal_node_type__.__isFragmentNode__;\n  }\n  get __isObjectNode__() {\n    return this.__internal_node_type__.__isObjectNode__;\n  }\n  get __isForwardRef__() {\n    return this.__internal_node_type__.__isForwardRef__;\n  }\n  get __isPortal__() {\n    return this.__internal_node_type__.__isPortal__;\n  }\n  get __isMemo__() {\n    return this.__internal_node_type__.__isMemo__;\n  }\n  get __isContextProvider__() {\n    return this.__internal_node_type__.__isContextProvider__;\n  }\n  get __isContextConsumer__() {\n    return this.__internal_node_type__.__isContextConsumer__;\n  }\n  get __isLazy__() {\n    return this.__internal_node_type__.__isLazy__;\n  }\n  get __isSuspense__() {\n    return this.__internal_node_type__.__isSuspense__;\n  }\n  get __isDynamicNode__() {\n    return this.__internal_node_type__.__isDynamicNode__;\n  }\n  get __isClassComponent__() {\n    return this.__internal_node_type__.__isClassComponent__;\n  }\n  get __isFunctionComponent__() {\n    return this.__internal_node_type__.__isFunctionComponent__;\n  }\n\n  setNodeType(props?: { [key in typeof NODE_TYPE_KEY[number]]?: boolean }) {\n    Object.keys(props || {}).forEach((key) => {\n      const typeKey = key as typeof NODE_TYPE_KEY[number];\n      this.__internal_node_type__[typeKey] = props?.[typeKey] || false;\n    });\n  }\n\n  isSameType(props?: { [key in typeof NODE_TYPE_KEY[number]]?: boolean }) {\n    if (props) {\n      return NODE_TYPE_KEY.every((key) =>\n        this.__internal_node_type__[key] ? Object.is(this.__internal_node_type__[key], props[key]) : true\n      );\n    } else {\n      return false;\n    }\n  }\n}\n"]}